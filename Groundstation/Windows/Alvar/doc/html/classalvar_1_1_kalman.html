<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>

<title>Kalman Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  
  
  
   
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.8.0 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="namespacealvar.html">alvar</a>      </li>
      <li class="navelem"><a class="el" href="classalvar_1_1_kalman.html">Kalman</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a>  </div>
  <div class="headertitle">
<div class="title">Kalman Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="classalvar_1_1_kalman.html" title="Kalman implementation.">Kalman</a> implementation.  
 <a href="classalvar_1_1_kalman.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_kalman_8h_source.html">Kalman.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for Kalman:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classalvar_1_1_kalman.png" usemap="#Kalman_map" alt=""/>
  <map id="Kalman_map" name="Kalman_map">
<area href="classalvar_1_1_kalman_core.html" title="Core implementation for Kalman." alt="KalmanCore" shape="rect" coords="0,0,81,24"/>
<area href="classalvar_1_1_kalman_ekf.html" title="Extended Kalman Filter (EKF) implementation." alt="KalmanEkf" shape="rect" coords="0,112,81,136"/>
</map>
 </div></div>

<p><a href="classalvar_1_1_kalman-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:add0d3881af973546a257fd6e1dcd8298"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classalvar_1_1_kalman.html#add0d3881af973546a257fd6e1dcd8298">Kalman</a> (int _n)</td></tr>
<tr class="memdesc:add0d3881af973546a257fd6e1dcd8298"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#add0d3881af973546a257fd6e1dcd8298"></a><br/></td></tr>
<tr class="memitem:ad0c6513d9400e6a237ef6e393135d0bb"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad0c6513d9400e6a237ef6e393135d0bb"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classalvar_1_1_kalman.html#ad0c6513d9400e6a237ef6e393135d0bb">~Kalman</a> ()</td></tr>
<tr class="memdesc:ad0c6513d9400e6a237ef6e393135d0bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor. <br/></td></tr>
<tr class="memitem:aedfe0c641afbd94cf40850de332a0fb4"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classalvar_1_1_kalman.html#aedfe0c641afbd94cf40850de332a0fb4">update_F</a> (unsigned long tick)</td></tr>
<tr class="memitem:a60532ff38a0447a6e4e1f78f108284a3"><td class="memItemLeft" align="right" valign="top">CvMat *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classalvar_1_1_kalman.html#a60532ff38a0447a6e4e1f78f108284a3">predict</a> (unsigned long tick)</td></tr>
<tr class="memdesc:a60532ff38a0447a6e4e1f78f108284a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Predict the <a class="el" href="classalvar_1_1_kalman.html" title="Kalman implementation.">Kalman</a> state vector for the given time step This calls <em>updateF</em> for updating the transition matrix based on the real time step.  <a href="#a60532ff38a0447a6e4e1f78f108284a3"></a><br/></td></tr>
<tr class="memitem:a2ddfde263de0bf9a41e5a304ed1f4e30"><td class="memItemLeft" align="right" valign="top">CvMat *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classalvar_1_1_kalman.html#a2ddfde263de0bf9a41e5a304ed1f4e30">predict_update</a> (<a class="el" href="classalvar_1_1_kalman_sensor.html">KalmanSensor</a> *sensor, unsigned long tick)</td></tr>
<tr class="memdesc:a2ddfde263de0bf9a41e5a304ed1f4e30"><td class="mdescLeft">&#160;</td><td class="mdescRight">Predict the <a class="el" href="classalvar_1_1_kalman.html" title="Kalman implementation.">Kalman</a> state vector for the given time step and update the state using the <a class="el" href="classalvar_1_1_kalman.html" title="Kalman implementation.">Kalman</a> gain.  <a href="#a2ddfde263de0bf9a41e5a304ed1f4e30"></a><br/></td></tr>
<tr class="memitem:aae8a46fb6f855cd7bf4049d2bce7c986"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aae8a46fb6f855cd7bf4049d2bce7c986"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classalvar_1_1_kalman.html#aae8a46fb6f855cd7bf4049d2bce7c986">seconds_since_update</a> (unsigned long tick)</td></tr>
<tr class="memdesc:aae8a46fb6f855cd7bf4049d2bce7c986"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper method. <br/></td></tr>
<tr><td colspan="2"><h2><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:ad7389e413ec544259e68b4a19f19da0f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad7389e413ec544259e68b4a19f19da0f"></a>
CvMat *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classalvar_1_1_kalman.html#ad7389e413ec544259e68b4a19f19da0f">P</a></td></tr>
<tr class="memdesc:ad7389e413ec544259e68b4a19f19da0f"><td class="mdescLeft">&#160;</td><td class="mdescRight">The error covariance matrix describing the accuracy of the state estimate. <br/></td></tr>
<tr class="memitem:afecad2d06d5bf8a60605d632a271b74c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afecad2d06d5bf8a60605d632a271b74c"></a>
CvMat *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classalvar_1_1_kalman.html#afecad2d06d5bf8a60605d632a271b74c">Q</a></td></tr>
<tr class="memdesc:afecad2d06d5bf8a60605d632a271b74c"><td class="mdescLeft">&#160;</td><td class="mdescRight">The covariance matrix for the process noise. <br/></td></tr>
<tr class="memitem:a040471519e51e99c8515780d0ed18667"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a040471519e51e99c8515780d0ed18667"></a>
CvMat *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classalvar_1_1_kalman.html#a040471519e51e99c8515780d0ed18667">P_pred</a></td></tr>
<tr class="memdesc:a040471519e51e99c8515780d0ed18667"><td class="mdescLeft">&#160;</td><td class="mdescRight">The predicted error covariance matrix. <br/></td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a67f35c0a2ba5542a35b80f4e953da470"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a67f35c0a2ba5542a35b80f4e953da470"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>predict_P</b> ()</td></tr>
<tr><td colspan="2"><h2><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a4121d0507501f60021622d833c373e8a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4121d0507501f60021622d833c373e8a"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>prev_tick</b></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p><a class="el" href="classalvar_1_1_kalman.html" title="Kalman implementation.">Kalman</a> implementation. </p>
<p>The <a class="el" href="classalvar_1_1_kalman.html" title="Kalman implementation.">Kalman</a> filter provides an effective way of estimating a system/process recursively (<a href="http://www.cs.unc.edu/~welch/media/pdf/kalman_intro.pdf">http://www.cs.unc.edu/~welch/media/pdf/kalman_intro.pdf</a>). In this implementation we have separated the <a class="el" href="classalvar_1_1_kalman.html" title="Kalman implementation.">Kalman</a> class (<em><a class="el" href="classalvar_1_1_kalman_core.html" title="Core implementation for Kalman.">KalmanCore</a></em>, <em><a class="el" href="classalvar_1_1_kalman.html" title="Kalman implementation.">Kalman</a></em> or <em><a class="el" href="classalvar_1_1_kalman_ekf.html" title="Extended Kalman Filter (EKF) implementation.">KalmanEkf</a></em>) from the sensor class (<em><a class="el" href="classalvar_1_1_kalman_sensor_core.html" title="Core implementation for Kalman sensor.">KalmanSensorCore</a></em>, <em><a class="el" href="classalvar_1_1_kalman_sensor.html" title="Kalman sensor implementation.">KalmanSensor</a></em> or <em><a class="el" href="classalvar_1_1_kalman_sensor_ekf.html" title="Extended Kalman Filter (EKF) sensor implementation.">KalmanSensorEkf</a></em>). The selected <a class="el" href="classalvar_1_1_kalman.html" title="Kalman implementation.">Kalman</a> class contains always the latest estimation of the process. The estimation can be updated using one or several sensors. This implementation allows SCAAT approach, where there may be several sensors (and several controls) for each <a class="el" href="classalvar_1_1_kalman.html" title="Kalman implementation.">Kalman</a> filter (See <a href="http://www.cs.unc.edu/~welch/scaat.html">http://www.cs.unc.edu/~welch/scaat.html</a>).</p>
<p>Currently we have have three levels of implementations for both <a class="el" href="classalvar_1_1_kalman.html" title="Kalman implementation.">Kalman</a> and Sensor (<em>core</em>, <em>"normal"</em> and <em>EKF</em>).</p>
<p>The <em>core</em> implementations can be used for really fast bare-bones core implementations when we have precalculated and constant <em>K</em>. In systems where <em>F</em>, <em>H</em>, <em>Q</em> and <em>R</em> are constants the <em>K</em> will converge into a constant and it can be precalculated. Note, that the core implementation need to assume constant frame rate if <em>F</em> depends on the timestep between frames. Note also, that the core-classes cannot use <em>EKF</em> Jacobians because they change the <em>H</em>.</p>
<p>The <em>"normal"</em> implementations are used when we have a linear <em>F</em> for <em><a class="el" href="classalvar_1_1_kalman.html" title="Kalman implementation.">Kalman</a></em>, or linear <em>H</em> for <em><a class="el" href="classalvar_1_1_kalman_sensor.html" title="Kalman sensor implementation.">KalmanSensor</a></em>. The <em>EKF</em> implementations are used when we have non-linear function <em>f()</em> for <em><a class="el" href="classalvar_1_1_kalman_ekf.html" title="Extended Kalman Filter (EKF) implementation.">KalmanEkf</a></em>, or non-linear function <em>h()</em> for <em><a class="el" href="classalvar_1_1_kalman_sensor_ekf.html" title="Extended Kalman Filter (EKF) sensor implementation.">KalmanSensorEkf</a></em>.</p>
<p>Furthermore we have a class <em><a class="el" href="classalvar_1_1_kalman_visualize.html" title="Class for visualizing Kalman filter.">KalmanVisualize</a></em> for visualizing the internal state of <em><a class="el" href="classalvar_1_1_kalman.html" title="Kalman implementation.">Kalman</a></em>.</p>
<p>Note, that now the <em>KalmanControl</em> is left out from this implementation. But it could be added using similar conventions as the <em><a class="el" href="classalvar_1_1_kalman_sensor.html" title="Kalman sensor implementation.">KalmanSensor</a></em>. </p>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="_sample_filter_8cpp-example.html#_a5">SampleFilter.cpp</a>.</dd>
</dl>
<p>Definition at line <a class="el" href="_kalman_8h_source.html#l00178">178</a> of file <a class="el" href="_kalman_8h_source.html">Kalman.h</a>.</p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="add0d3881af973546a257fd6e1dcd8298"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classalvar_1_1_kalman.html">Kalman</a> </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>_n</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Constructor. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>The number of items in the <a class="el" href="classalvar_1_1_kalman.html" title="Kalman implementation.">Kalman</a> state vector </td></tr>
    <tr><td class="paramname">_m</td><td>The number of measurements given by this sensor </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a60532ff38a0447a6e4e1f78f108284a3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CvMat* <a class="el" href="classalvar_1_1_kalman.html#a60532ff38a0447a6e4e1f78f108284a3">predict</a> </td>
          <td>(</td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>tick</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Predict the <a class="el" href="classalvar_1_1_kalman.html" title="Kalman implementation.">Kalman</a> state vector for the given time step This calls <em>updateF</em> for updating the transition matrix based on the real time step. </p>
<p>x_pred = F*x P_pred = F*P*trans(F) + Q </p>

</div>
</div>
<a class="anchor" id="a2ddfde263de0bf9a41e5a304ed1f4e30"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CvMat* <a class="el" href="classalvar_1_1_kalman.html#a2ddfde263de0bf9a41e5a304ed1f4e30">predict_update</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classalvar_1_1_kalman_sensor.html">KalmanSensor</a> *&#160;</td>
          <td class="paramname"><em>sensor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>tick</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Predict the <a class="el" href="classalvar_1_1_kalman.html" title="Kalman implementation.">Kalman</a> state vector for the given time step and update the state using the <a class="el" href="classalvar_1_1_kalman.html" title="Kalman implementation.">Kalman</a> gain. </p>
<ul>
<li>Calls first the predict to ensure that the prediction is based on same timestep as the update</li>
<li>K = P_pred * trans(H) * inv(H*P_pred*trans(H) + R)</li>
<li>x = x_pred + K* ( z - H*x_pred)</li>
<li>P = (I - K*H) * P_pred </li>
</ul>

</div>
</div>
<a class="anchor" id="aedfe0c641afbd94cf40850de332a0fb4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void <a class="el" href="classalvar_1_1_kalman.html#aedfe0c641afbd94cf40850de332a0fb4">update_F</a> </td>
          <td>(</td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>tick</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>If your transition matrix F is based on time you need to override this method. </p>

<p>Reimplemented in <a class="el" href="classalvar_1_1_kalman_ekf.html#aedfe0c641afbd94cf40850de332a0fb4">KalmanEkf</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="_kalman_8h_source.html">Kalman.h</a></li>
</ul>
</div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Tue May 29 2012 19:00:19 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.0
</small></address>

</body>
</html>
